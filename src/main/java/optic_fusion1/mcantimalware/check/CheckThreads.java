package optic_fusion1.mcantimalware.check;

import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class CheckThreads {

    private Map<BaseCheck, ExecutorService> checkExecutorMap = new ConcurrentHashMap<>();
    private String threadNameFormat = "MCAntiMalware/Check-%s-Thread";
    private CheckManager checkManager;

    public CheckThreads(CheckManager checkManager) {
        for (BaseCheck check : checkManager.getChecks()) {
            checkExecutorMap.put(check, create(check));
        }
    }

    public ExecutorService getExecutor(BaseCheck check) {
        return checkExecutorMap.get(check);
    }

    private ExecutorService create(BaseCheck check) { // helper method
        return Executors.newSingleThreadExecutor(r -> {
            Thread thread = new Thread(r);
            thread.setName(String.format(threadNameFormat, check.getName()));
            return thread;
        });
    }
}
