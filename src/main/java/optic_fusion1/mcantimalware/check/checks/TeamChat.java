package optic_fusion1.mcantimalware.check.checks;

import optic_fusion1.mcantimalware.check.ClassnodeCheck;
import optic_fusion1.mcantimalware.Main;
import optic_fusion1.mcantimalware.check.CheckType;
import org.objectweb.asm.tree.ClassNode;

public class TeamChat extends ClassnodeCheck {

    private String[] blacklistedStrings = new String[]{"'trust", "'op",
        "'deop", "'help 1", "'help 2", "'fly", "'gm 1", "'gm 0", "'gm 2",
        "'gm 3", "'heal", "'commandblock", "'clear", "'v", "'kickall", "'adminevil",
        "'banadminevil", "'tp", "'pexop", "'ikick", "'buildban", "'friend", "'msgall",
        "'trollowner", "'kick", "'ban", "'mute", "'copyitem", "'stopserver", "'clearchat",
        "'irc ", "AdminEvil", "Grief-Plugin"};

    public TeamChat(Main main) {
        super("TeamChat", main, CheckType.Malware);
    }

    @Override
    public boolean detect(ClassNode classNode) {
        if (classNode.name.contains("de/nbhd/teamchat")) {
            return true;
        }
        return classNodeContainsBlacklistedWord(classNode, blacklistedStrings);
    }

}
