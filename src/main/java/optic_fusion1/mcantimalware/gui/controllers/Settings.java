package optic_fusion1.mcantimalware.gui.controllers;

import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.TextField;
import javafx.scene.control.ToggleButton;
import javafx.stage.DirectoryChooser;
import optic_fusion1.mcantimalware.gui.GuiLauncher;
import optic_fusion1.mcantimalware.utils.FxGuiUtil;

import java.io.File;
import java.net.URL;
import java.util.ResourceBundle;

import static optic_fusion1.mcantimalware.AntiMalware.getMain;

public class Settings implements Initializable {
    @FXML
    private TextField scanDir;
    @FXML
    private ToggleButton zipMaliciousPlugins;
    @FXML
    private ToggleButton falsePositivesGalore;

    @FXML
    public void chooseDir(){
        DirectoryChooser chooser = new DirectoryChooser();
        if(scanDir.getText() != null) {
            File f = new File(scanDir.getText());
            if(f.isDirectory()) chooser.setInitialDirectory(f);
        }
        File f = chooser.showDialog(GuiLauncher.stage);
        if(f != null){
            scanDir.setText(f.getPath());
        }
    }

    @FXML
    public void save(){
        getMain().setScanDirectory(new File(scanDir.getText()));
        getMain().setZipMaliciousPlugins(zipMaliciousPlugins.isSelected());
        getMain().setFalsePositivesGalore(falsePositivesGalore.isSelected());
        GuiLauncher.saveConf();
        FxGuiUtil.info("Saved xD");
        GuiLauncher.openDashboard();
    }

    @FXML
    public void cancel(){
        GuiLauncher.openDashboard();
    }

    @FXML
    public void fpg(){
        falsePositivesGalore.setText(falsePositivesGalore.isSelected() ? "Enabled" : "Disabled");
    }

    @FXML
    public void zmp(){
        zipMaliciousPlugins.setText(zipMaliciousPlugins.isSelected() ? "Enabled" : "Disabled");
    }

    @Override
    public void initialize(URL url, ResourceBundle resourceBundle) {
        scanDir.setText(getMain().getScanDirectory().getPath());
        zipMaliciousPlugins.setSelected(getMain().shouldZipMaliciousPlugins());
        zipMaliciousPlugins.setText(zipMaliciousPlugins.isSelected() ? "Enabled" : "Disabled");
        falsePositivesGalore.setSelected(getMain().falsePositivesGalore());
        falsePositivesGalore.setText(falsePositivesGalore.isSelected() ? "Enabled" : "Disabled");
    }
}
