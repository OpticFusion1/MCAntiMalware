package xbrowniecodez.mcantimalware.check.directleaks;

import java.util.Iterator;

import org.objectweb.asm.tree.ClassNode;
import org.objectweb.asm.tree.FieldNode;
import org.objectweb.asm.tree.MethodNode;

public class BootstrapCheck {
	public static boolean BootstrapCheck1(ClassNode classNode) {
		Iterator<MethodNode> iterator = classNode.methods.iterator();
		while (iterator.hasNext()) {
			MethodNode methodNode = iterator.next();
			if (methodNode.desc.equalsIgnoreCase(
					"(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/Class;Ljava/lang/String;I)Ljava/lang/invoke/CallSite;")) {
				return true;

			}
		}
		return false;
	}
	public static boolean BootstrapCheck2(ClassNode classNode) {
		if (classNode.superName.equals("org/bukkit/plugin/java/JavaPlugin")
				|| classNode.superName.equals("net/md_5/bungee/api/plugin/Plugin")) {
			for (Iterator<FieldNode> it = classNode.fields.iterator(); it.hasNext();) {
				FieldNode fieldNode = it.next();
				if (fieldNode.access == 9 && fieldNode.desc.equalsIgnoreCase("I") && fieldNode.name.length() == 36) {
					return true;
				} else if (fieldNode.access == 9 && fieldNode.desc.equalsIgnoreCase("Ljava/lang/String;")
						&& fieldNode.name.length() == 36) {
					return true;
				}
			}
		}
		return false;
	}
}
