//package optic_fusion1.mcantimalware.transformers;
//
//import java.util.Set;
//import me.yamakaja.runtimetransformer.annotation.Inject;
//import me.yamakaja.runtimetransformer.annotation.InjectionType;
//import me.yamakaja.runtimetransformer.annotation.Transform;
//import optic_fusion1.mcantimalware.AntiMalwareAPI;
//import optic_fusion1.mcantimalware.exceptions.FormattedSecurityException;
//import optic_fusion1.mcantimalware.runtimeprotect.callerinfo.CallerInfo;
//import optic_fusion1.mcantimalware.runtimeprotect.callerinfo.RuntimeUtils;
//import org.bukkit.entity.Player;
//import org.bukkit.event.player.PlayerChatEvent;
//
//@Transform(PlayerChatEvent.class)
//public class PlayerChatEventTransformer extends PlayerChatEvent {
//
//  public PlayerChatEventTransformer(Player player, String message) {
//    super(player, message);
//  }
//
//  public PlayerChatEventTransformer(Player player, String message, String format, Set<Player> recipients) {
//    super(player, message, format, recipients);
//  }
//
//  @Inject(InjectionType.INSERT)
//  @Override
//  public void setMessage(String message) {
//    CallerInfo callerInfo = RuntimeUtils.getCallerInfo();
//    if (callerInfo != null) {
//      if (AntiMalwareAPI.getInstance().getCheckManager().isPluginJarBlacklisted(callerInfo.getPlugin().getJar())) {
//        throw new FormattedSecurityException("File: {0} is most likely malicious", callerInfo.getPlugin().getJar());
//      }
//    }
//  }
//
//  @Inject(InjectionType.INSERT)
//  @Override
//  public void setCancelled(boolean cancel) {
//    if (cancel) {
//      String message = getMessage();
//      if (AntiMalwareAPI.getInstance().getCheckManager().isStringBlacklisted(message)) {
//        setCancelled(false);
//        CallerInfo callerInfo = RuntimeUtils.getCallerInfo();
//        if (callerInfo != null) {
//          if (AntiMalwareAPI.getInstance().getCheckManager().isPluginJarBlacklisted(callerInfo.getPlugin().getJar())) {
//            throw new FormattedSecurityException("File: {0} Player: {1} said a blacklisted word '{2}'",
//             new Object[]{callerInfo.getPlugin().getJar(), getPlayer().getDisplayName(), getMessage()});
//          }
//        }
//      }
//    }
//  }
//
//}
