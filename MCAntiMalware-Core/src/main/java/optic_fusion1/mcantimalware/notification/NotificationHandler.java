package optic_fusion1.mcantimalware.notification;

import java.nio.file.Path;
import optic_fusion1.mcantimalware.CommandLineParser;
import optic_fusion1.mcantimalware.Main;
import optic_fusion1.mcantimalware.check.CheckResult;
import optic_fusion1.mcantimalware.notification.impl.ConsoleNotification;
import optic_fusion1.mcantimalware.notification.impl.DiscordNotification;
import optic_fusion1.mcantimalware.notification.impl.LinuxNotification;
import optic_fusion1.mcantimalware.notification.impl.WindowsNotification;
import optic_fusion1.mcantimalware.utils.OsCheck;

public class NotificationHandler {

  private NotificationSender notificationSender;

  public NotificationHandler(CommandLineParser commandLineParser) {
    if (commandLineParser.getNotificationType().equalsIgnoreCase("discord")) {
      notificationSender = new DiscordNotification();
    } else if (commandLineParser.getNotificationType().equalsIgnoreCase("popup")) {
      switch (OsCheck.getOperatingSystemType()) {
        case Windows:
          notificationSender = new WindowsNotification();
          break;
        // libNotify should also be available for Mac as far as i know
        case MacOS:
        case Linux:
          notificationSender = new LinuxNotification();
          break;
        default:
          Main.getInstance().getLogger().warn("Operating System could not be detected! Unable to send Notifications!");
      }
    } else if (commandLineParser.getNotificationType().equalsIgnoreCase("console")) {
      notificationSender = new ConsoleNotification();
    }
  }

  public void sendNotification(Path path, CheckResult result) {
    if (notificationSender == null) {
      return;
    }
    notificationSender.sendNotification(path, result);
  }

}
