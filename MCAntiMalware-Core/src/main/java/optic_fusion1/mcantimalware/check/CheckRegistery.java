package optic_fusion1.mcantimalware.check;

import optic_fusion1.mcantimalware.Main;
import static optic_fusion1.mcantimalware.Main.LOGGER;
import optic_fusion1.mcantimalware.check.impl.CashPloitCheck;
import optic_fusion1.mcantimalware.check.impl.Check;
import optic_fusion1.mcantimalware.check.impl.DirectLeaksCheck;
import optic_fusion1.mcantimalware.check.impl.EmptyPlugin;
import optic_fusion1.mcantimalware.check.impl.ForceOpCheck;
import optic_fusion1.mcantimalware.check.impl.NightVisionPlusCheck;
import optic_fusion1.mcantimalware.database.AntiMalwareDatabase;
import optic_fusion1.mcantimalware.utils.I18n;

public class CheckRegistery {

  private final CheckManager checkManager;
  private final Main main;
  private AntiMalwareDatabase database;

  public CheckRegistery(Main main) {
    this.main = main;
    this.checkManager = main.getCheckManager();
    database = main.getDatabase();
  }

  public void reloadCheckDatabase() {
    LOGGER.info(I18n.tl("local_check_database_update"));
    database = main.getDatabase();
    LOGGER.info(I18n.tl("local_check_database_updated"));
  }

  public void registerChecks() {
    LOGGER.info(I18n.tl("registering_checks"));
    addCheck(new CashPloitCheck(main));
    addCheck(new DirectLeaksCheck(main));
    addCheck(new EmptyPlugin(main));
    addCheck(new ForceOpCheck(main));
    addCheck(new NightVisionPlusCheck(main));
    addCheck(new Check(main));
    LOGGER.info(I18n.tl("registered_checks"));
  }

  private void addCheck(BaseCheck check) {
    checkManager.addCheck(check);
  }
}
