package optic_fusion1.mcantimalware;

import java.io.File;
import co.aikar.taskchain.TaskChainFactory;
import optic_fusion1.mcantimalware.check.CheckManager;
import optic_fusion1.mcantimalware.configuration.file.FileConfiguration;
import optic_fusion1.mcantimalware.logging.CustomLogger;
import optic_fusion1.mcantimalware.realtimescanning.RealTimeScanner;
import optic_fusion1.mcantimalware.runtimeprotect.PluginIndex;

public final class AntiMalware extends AntiMalwareAPI {

  private final Main main;

  protected AntiMalware(Main main) {
    this.main = main;
    AntiMalwareAPI.setInstance(this);
  }

  public Main getMain() {
    return main;
  }

  public CommandLineHandler getCommandLineHandler() {
    return main.getCommandLineHandler();
  }

  @Override
  public CustomLogger getLogger() {
    return main.getLogger();
  }

  @Override
  public TaskChainFactory getChainFactory() {
    return main.getChainFactory();
  }

  @Override
  public CheckManager getCheckManager() {
    return main.getCheckManager();
  }

  @Override
  public RealTimeScanner getRealTimeScanner() {
    return main.getRealTimeScanner();
  }

  public FileConfiguration getChecksumDatabase() {
    return main.getChecksumDatabase();
  }

  public FileConfiguration getCheckDatabase() {
    return main.getCheckDatabase();
  }

  @Override
  public File getDataFolder() {
    return main.getDataFolder();
  }

  @Override
  public boolean canUseSpigotMethods() {
    return main.canUseSpigotMethods();
  }

  @Override
  public PluginIndex getPluginIndex() {
    return getCommandLineHandler().getPluginIndex();
  }

  public static AntiMalware getInstance() {
    return (AntiMalware) AntiMalwareAPI.getInstance();
  }
}
