package optic_fusion1.antimalware.ui.view.viewmodels;

import javafx.beans.property.ListProperty;
import javafx.beans.property.SimpleListProperty;
import javafx.collections.FXCollections;
import optic_fusion1.antimalware.Main;
import optic_fusion1.antimalware.ui.view.ViewModel;

import java.nio.file.Path;
import java.util.ArrayList;
import java.util.function.Consumer;

public class MCAntiMalwareViewModel implements ViewModel {

    private final ListProperty<Path> filesProperty = new SimpleListProperty<>(FXCollections.observableList(new ArrayList<>()));

    private final ListProperty<Path> scannedProperty = new SimpleListProperty<>(FXCollections.observableList(new ArrayList<>()));

    private Consumer<String> onFound; // TODO:

    public void registerFile(Path file) {
        filesProperty.get().add(file);
    }

    public void scanFiles() {

        if(filesProperty.isEmpty())
            return;

        for(Path file : filesProperty.get()) {
            Main.getAntiMalware().getScanner().addFileToQueue(file);
            scannedProperty.add(file);
        }

        scannedProperty.clear();
        filesProperty.clear();
    }

    public void setOnFound(Consumer<String> onFound) {
        this.onFound = onFound;
    }

    public ListProperty<Path> scannedProperty() {
        return scannedProperty;
    }

    public ListProperty<Path> filesProperty() {
        return filesProperty;
    }
}
